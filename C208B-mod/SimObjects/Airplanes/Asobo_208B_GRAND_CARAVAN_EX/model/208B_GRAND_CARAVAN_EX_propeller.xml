<?xml version="1.0" encoding="UTF-8"?>
<ModelBehaviors>

<Template Name="ASOBO_ENGINE_Lever_Propeller_Template_Mod">
	<Parameters Type="Default">
		<ENGINE_ID>1</ENGINE_ID>
		<INPUT_EVENT_ID_SOURCE>ENGINE_Propeller</INPUT_EVENT_ID_SOURCE>
		<IE_NAME>Lever</IE_NAME>
		<IDLE>0.25</IDLE> <!-- ANIMATION MIN POSITION -->
		<UPPER_LIMIT>16384</UPPER_LIMIT>
		<UPPER_LIMIT_PCT>100</UPPER_LIMIT_PCT>
		<LOWER_LIMIT Process="Int">@FeatherPropPos 16384 * 0 (A:THROTTLE LOWER LIMIT, position 16k) 0 &lt; ?</LOWER_LIMIT>
		<LOWER_LIMIT_PCT Process="Float">@FeatherPropPos 100 *</LOWER_LIMIT_PCT>
	</Parameters>
	<Parameters Type="Default">
		<MAIN_LEVER_REVERSE_POSITION Process="Int">@FeatherPropPos 16384 * 0 #LOWER_LIMIT# 0 &lt; ?</MAIN_LEVER_REVERSE_POSITION>
		<MAIN_LEVER_REVERSE_POSITION_PCT Process="Int">@FeatherPropPos 100 * 0 #LOWER_LIMIT# 0 &lt; ?</MAIN_LEVER_REVERSE_POSITION_PCT>
	</Parameters>
	<Parameters Type="Default">
		<TRUE_IDLE_01 Process="Float">0 #MAIN_LEVER_REVERSE_POSITION_PCT# - 100 #MAIN_LEVER_REVERSE_POSITION_PCT# - /</TRUE_IDLE_01>
	</Parameters>
	<Parameters Type="Default">
		<INCREMENT>1</INCREMENT>
		<DELTA_MIN>0.00025</DELTA_MIN>
		<!-- adjust drag value based on anim value (positive range) -->
		<LERP_IDLE_FULL>l0 #IDLE# - 1 #IDLE# - / 1 #TRUE_IDLE_01# - * #TRUE_IDLE_01# +</LERP_IDLE_FULL>
		<!-- adjust drag value based on anim value (negative range) -->
		<LERP_IDLE_REVERSE>l0 #IDLE# - #IDLE# / #TRUE_IDLE_01# * #TRUE_IDLE_01# +</LERP_IDLE_REVERSE>
		<SCROLL_INCREMENT>701</SCROLL_INCREMENT>
	</Parameters>
	<Parameters Type="Default">
		<ADJUST_RAW_DRAG_VALUE>sp0 #LERP_IDLE_FULL# #LERP_IDLE_REVERSE# l0 #IDLE# &gt; ?</ADJUST_RAW_DRAG_VALUE>	
		<MIN_DIFF_POS>5</MIN_DIFF_POS>
		<DRAG_VALUE_OVERRIDE/>
	</Parameters>
	<Parameters Type="Override">
		<DRAG_MIN_VALUE>#MAIN_LEVER_REVERSE_POSITION# (O:XMLVAR_MIN_Limit) max</DRAG_MIN_VALUE>
		<DRAG_MAX_VALUE>#UPPER_LIMIT# (O:XMLVAR_MAX_Limit) min</DRAG_MAX_VALUE>
		<PROCESS_LIMITS>
			(L:XMLVAR_Propeller_Lever_Position#ENGINE_ID#) 0 &gt; if{
				0 (&gt;O:XMLVAR_MIN_Limit)
				#UPPER_LIMIT# (&gt;O:XMLVAR_MAX_Limit)
			} els{
				#MAIN_LEVER_REVERSE_POSITION# (&gt;O:XMLVAR_MIN_Limit)
				0 (&gt;O:XMLVAR_MAX_Limit)
			}
		</PROCESS_LIMITS>
		<RESET_LIMITS>
			#MAIN_LEVER_REVERSE_POSITION# (&gt;O:XMLVAR_MIN_Limit)
			#UPPER_LIMIT# (&gt;O:XMLVAR_MAX_Limit)
		</RESET_LIMITS>
	</Parameters>

	<Component ID="#PART_ID#" Node="#NODE_ID#">

		<Update Once="True">
			#RESET_LIMITS#
		</Update>

		<UseInputEvent ID="CESSNA_MOD">
			<CURSOR>Hand</CURSOR>
			<DRAG_AXIS_SCALE>-163.84</DRAG_AXIS_SCALE>
			<TT_DESCRIPTION>#ENGINE_ID# (R:1:@TT_Package.ENGINE_PROPELLER_ACTION_SOLO) @sprintf</TT_DESCRIPTION>
			<TT_DESCRIPTION_IS_DYNAMIC>True</TT_DESCRIPTION_IS_DYNAMIC>
		</UseInputEvent>

		<UseTemplate Name="ASOBO_GT_Anim_Code">
			<ANIM_CODE>
				(B:#INPUT_EVENT_ID_SOURCE#_#IE_NAME#, percent over 100) sp0
				l0 #TRUE_IDLE_01# - 1 #TRUE_IDLE_01# - / 1 #IDLE# - * #IDLE# + (* Upper part of propeller *)
				l0 #TRUE_IDLE_01# / #IDLE# * (* Reverse *)
				l0 #TRUE_IDLE_01# &gt; ? 100 *
			</ANIM_CODE>
		</UseTemplate>

		<UseTemplate Name="ASOBO_GT_Interaction_WheelLeftDrag_Axis">
			<NO_ARROWS/>
			<AXIS>Y</AXIS>
			<HELPID>HELPID_GAUGE_THROTTLE_THROTTLE</HELPID>
			<TOOLTIPID>TT:COCKPIT.TOOLTIPS.PROP_RPM_LEVER</TOOLTIPID>
			<TOOLTIP_TITLE>@TT_Package.ENGINE_PROPELLER_TITLE</TOOLTIP_TITLE>
			<TOOLTIP_ENTRY_0>#INPUT_EVENT_ID_SOURCE#_#IE_NAME#</TOOLTIP_ENTRY_0>
			<DOWN_CODE>
				(L:XMLVAR_Propeller_Lever_Position#ENGINE_ID#) 0 == if{
					1 (&gt;O:XMLVAR_Limits_Needs_Recalculation)
				} els{
					#PROCESS_LIMITS#
				}
			</DOWN_CODE>
			<RELEASE_CODE>
				#RESET_LIMITS#
			</RELEASE_CODE>
			<USE_TRAJECTORY_DRAG_MODE>True</USE_TRAJECTORY_DRAG_MODE>
			<DRAG_ANIM_NAME>#ANIM_NAME#</DRAG_ANIM_NAME>
			<DRAG_CODE>
				(M:InputType) 1 == if{
					(O:_ResetLimitsTime) (E:SIMULATION TIME, second) &lt; if{
							(L:XMLVAR_Propeller_Lever_Position#ENGINE_ID#) abs #MIN_DIFF_POS# &lt; if{
							#RESET_LIMITS#
							1 (&gt;O:XMLVAR_Limits_Needs_Recalculation)
						}
					}
					(E:SIMULATION TIME, second) 0.1 + (&gt;O:_ResetLimitsTime)
				}
				16384 #MAIN_LEVER_REVERSE_POSITION# - (M:DragPercent) #ADJUST_RAW_DRAG_VALUE# * #MAIN_LEVER_REVERSE_POSITION# + sp0
				#DRAG_VALUE_OVERRIDE#
				l0 #DRAG_MAX_VALUE# min #DRAG_MIN_VALUE# max 16384 / (&gt;B:#INPUT_EVENT_ID_SOURCE#_#IE_NAME#_Set)
				(O:XMLVAR_Limits_Needs_Recalculation) if{
						(L:XMLVAR_Propeller_Lever_Position#ENGINE_ID#) abs #MIN_DIFF_POS# &gt; if{
						#PROCESS_LIMITS#
						0 (&gt;O:XMLVAR_Limits_Needs_Recalculation)
					}
				}
			</DRAG_CODE>
			<POSITIVE_AXIS_CODE>1 (&gt;B:#INPUT_EVENT_ID_SOURCE#_#IE_NAME#_Inc)</POSITIVE_AXIS_CODE>
			<NEGATIVE_AXIS_CODE>1 (&gt;B:#INPUT_EVENT_ID_SOURCE#_#IE_NAME#_Dec)</NEGATIVE_AXIS_CODE>
		</UseTemplate>

		<UseTemplate Name="ASOBO_GT_Visibility_Code">
			<VISIBILITY_CODE>(L:XMLVAR_LeverPropellerHidden) !</VISIBILITY_CODE>
		</UseTemplate>
	</Component>
</Template>

<Template Name="ASOBO_ELECTRICAL_Switch_PropGovTest_Template_Mod">
	<Component ID="#PART_ID#" Node="#NODE_ID#">
		<UseTemplate Name="ASOBO_GT_Push_Button_Held_Simple">
			<LEFT_SINGLE_CODE>
				1 (&gt;L:XMLVAR_Overspeed_Test)
				9200 (&gt;K:PROP_PITCH1_SET)
			</LEFT_SINGLE_CODE>
			<LEFT_LEAVE_CODE>
				0 (&gt;L:XMLVAR_Overspeed_Test)
				0 (&gt;B:ENGINE_Propeller_Lever_Inc)
			</LEFT_LEAVE_CODE>
			<ANIM_CODE>(L:XMLVAR_Overspeed_Test) 100 *</ANIM_CODE>
		</UseTemplate>
	</Component>
</Template>

</ModelBehaviors>